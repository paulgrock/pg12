// Generated by CoffeeScript 1.3.3
(function() {
  var $navLinks, calculateSide, clickFlip, getNewContent;

  $navLinks = $("nav").find("a");

  clickFlip = function(evt) {
    var side;
    evt.preventDefault();
    side = calculateSide(evt, this);
    if (side !== "back") {
      getNewContent(evt);
      $navLinks.removeClass("flipLeft flipRight flipFront");
      if (side === "front left") {
        return $(this).addClass("flipLeft").siblings().addClass("flipFront");
      } else if (side === "front right") {
        return $(this).addClass("flipRight").siblings().addClass("flipFront");
      }
    }
  };

  calculateSide = function(evt, elem) {
    var back, left, width;
    width = $(elem).width();
    left = evt.offsetX;
    back = $(elem).hasClass("back");
    if (!back) {
      if (left < width / 2) {
        return "front left";
      } else {
        return "front right";
      }
    } else {
      return "back";
    }
  };

  getNewContent = function(evt) {
    var $content, location, pageLoad, sliding;
    location = evt.target.href.split("/");
    pageLoad = $.ajax({
      "url": "/" + location[location.length - 1]
    });
    $content = $("#content");
    history.pushState({
      "page": location[location.length - 1]
    }, location[location.length - 1] + " |  paulgrock.com", "/" + location[location.length - 1]);
    sliding = $content.slideUp("fast");
    return $.when(sliding.promise(), pageLoad).done(function(elem, data) {
      return $content.html($(data[0]).find("#content").html()).slideDown("fast");
    });
  };

  $navLinks.click(clickFlip);

}).call(this);
